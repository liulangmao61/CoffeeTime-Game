<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸¸å®¢æ¨¡å¼åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 { color: #333; }
        h2 { color: #666; margin-top: 0; }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        #log {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry { margin: 5px 0; padding: 5px; border-bottom: 1px solid #ddd; }
        .log-time { color: #666; margin-right: 10px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª æ¸¸å®¢æ¨¡å¼åŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>æµ‹è¯•æ­¥éª¤</h2>
        <ol>
            <li>æ‰“å¼€æ¸¸æˆä¸»é¡µé¢ï¼šhttp://localhost:8000/</li>
            <li>ç‚¹å‡»"æ¸¸å®¢æ¨¡å¼"æŒ‰é’®</li>
            <li>éªŒè¯æ˜¯å¦æˆåŠŸè¿›å…¥æ¸¸æˆä¸»ç•Œé¢</li>
            <li>æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦æ˜¾ç¤ºä¸º"æ¸¸å®¢"</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•æ§åˆ¶</h2>
        <button onclick="openGame()">æ‰“å¼€æ¸¸æˆ</button>
        <button onclick="checkLocalStorage()">æ£€æŸ¥æœ¬åœ°å­˜å‚¨</button>
        <button onclick="clearStorage()">æ¸…é™¤å­˜å‚¨</button>
        <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•ç»“æœ</h2>
        <div id="test-results"></div>
    </div>
    
    <div class="test-section">
        <h2>æµ‹è¯•æ—¥å¿—</h2>
        <div id="log"></div>
    </div>
    
    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            const time = new Date().toLocaleTimeString();
            entry.innerHTML = `<span class="log-time">[${time}]</span> ${message}`;
            logDiv.insertBefore(entry, logDiv.firstChild);
            console.log(`[${type}] ${message}`);
        }
        
        function addResult(message, type) {
            const resultsDiv = document.getElementById('test-results');
            const result = document.createElement('div');
            result.className = `test-result ${type}`;
            result.textContent = message;
            resultsDiv.appendChild(result);
        }
        
        function openGame() {
            log('æ­£åœ¨æ‰“å¼€æ¸¸æˆé¡µé¢...', 'info');
            window.open('http://localhost:8000/', '_blank');
            log('æ¸¸æˆé¡µé¢å·²åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€', 'success');
            addResult('æ¸¸æˆé¡µé¢å·²æ‰“å¼€ï¼Œè¯·åœ¨æ–°æ ‡ç­¾é¡µä¸­æµ‹è¯•æ¸¸å®¢æ¨¡å¼åŠŸèƒ½', 'info');
        }
        
        function checkLocalStorage() {
            log('æ£€æŸ¥æœ¬åœ°å­˜å‚¨...', 'info');
            const storageData = localStorage.getItem('coffee_time_game');
            if (storageData) {
                try {
                    const parsed = JSON.parse(storageData);
                    log('æ‰¾åˆ°æ¸¸æˆæ•°æ®', 'success');
                    addResult(`ç”¨æˆ·å: ${parsed.data.user.name}`, 'success');
                    addResult(`ç­‰çº§: Lv.${parsed.data.user.level}`, 'success');
                    addResult(`é‡‘å¸: ${parsed.data.resources.coins}`, 'success');
                } catch (e) {
                    log('è§£ææ¸¸æˆæ•°æ®å¤±è´¥: ' + e.message, 'error');
                    addResult('è§£ææ¸¸æˆæ•°æ®å¤±è´¥', 'error');
                }
            } else {
                log('æœªæ‰¾åˆ°æ¸¸æˆæ•°æ®', 'info');
                addResult('æœªæ‰¾åˆ°æ¸¸æˆæ•°æ®ï¼Œè¯·å…ˆä½¿ç”¨æ¸¸å®¢æ¨¡å¼ç™»å½•', 'info');
            }
        }
        
        function clearStorage() {
            log('æ¸…é™¤æœ¬åœ°å­˜å‚¨...', 'info');
            localStorage.removeItem('coffee_time_game');
            log('æœ¬åœ°å­˜å‚¨å·²æ¸…é™¤', 'success');
            addResult('æœ¬åœ°å­˜å‚¨å·²æ¸…é™¤ï¼Œå¯ä»¥é‡æ–°æµ‹è¯•æ¸¸å®¢æ¨¡å¼', 'success');
        }
        
        function runAllTests() {
            log('å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...', 'info');
            document.getElementById('test-results').innerHTML = '';
            
            addResult('æµ‹è¯• 1: æ£€æŸ¥ EventBinder æ¨¡å—æ˜¯å¦åŠ è½½', 'info');
            if (typeof EventBinder !== 'undefined') {
                addResult('âœ“ EventBinder æ¨¡å—å·²åŠ è½½', 'success');
                log('EventBinder æ¨¡å—å·²åŠ è½½', 'success');
            } else {
                addResult('âœ— EventBinder æ¨¡å—æœªåŠ è½½', 'error');
                log('EventBinder æ¨¡å—æœªåŠ è½½', 'error');
            }
            
            addResult('æµ‹è¯• 2: æ£€æŸ¥ Game æ¨¡å—æ˜¯å¦åŠ è½½', 'info');
            if (typeof Game !== 'undefined') {
                addResult('âœ“ Game æ¨¡å—å·²åŠ è½½', 'success');
                log('Game æ¨¡å—å·²åŠ è½½', 'success');
            } else {
                addResult('âœ— Game æ¨¡å—æœªåŠ è½½', 'error');
                log('Game æ¨¡å—æœªåŠ è½½', 'error');
            }
            
            addResult('æµ‹è¯• 3: æ£€æŸ¥ DOM å…ƒç´ æ˜¯å¦å­˜åœ¨', 'info');
            const guestBtn = document.getElementById('guest-btn');
            if (guestBtn) {
                addResult('âœ“ guest-btn å…ƒç´ å­˜åœ¨', 'success');
                log('guest-btn å…ƒç´ å­˜åœ¨', 'success');
            } else {
                addResult('âœ— guest-btn å…ƒç´ ä¸å­˜åœ¨ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºè¿™æ˜¯æµ‹è¯•é¡µé¢ï¼‰', 'info');
                log('guest-btn å…ƒç´ ä¸å­˜åœ¨ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼‰', 'info');
            }
            
            addResult('æµ‹è¯• 4: æ£€æŸ¥æœ¬åœ°å­˜å‚¨', 'info');
            checkLocalStorage();
            
            log('æ‰€æœ‰æµ‹è¯•å·²å®Œæˆ', 'success');
            addResult('æ‰€æœ‰æµ‹è¯•å·²å®Œæˆï¼Œè¯·æ‰“å¼€æ¸¸æˆé¡µé¢æµ‹è¯•æ¸¸å®¢æ¨¡å¼åŠŸèƒ½', 'success');
        }
        
        log('æµ‹è¯•é¡µé¢å·²åŠ è½½', 'info');
        addResult('æµ‹è¯•é¡µé¢å·²å‡†å¤‡å°±ç»ª', 'success');
    </script>
</body>
</html>
